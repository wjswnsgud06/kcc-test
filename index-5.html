<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í˜„ì‹¤ ì‚¬ê±´ ê¸°ë°˜ íˆ¬ì ì‹œë®¬ë ˆì´ì…˜</title>
<style>
body { font-family: Arial; background:#f4f6f9; padding:20px; }
.container { max-width:1100px; margin:auto; }
.card {
  background:white;
  padding:15px;
  margin-bottom:15px;
  border-radius:10px;
  box-shadow:0 3px 8px rgba(0,0,0,0.1);
}
button {
  padding:6px 10px;
  margin:3px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.buy { background:#2ecc71; color:white; }
.sell { background:#e74c3c; color:white; }
.next { background:#3498db; color:white; padding:10px 15px; }
input { width:60px; }
.summary { background:#eef2f7; padding:10px; margin-bottom:15px; border-radius:8px; }
h3 { margin-top:0; }
</style>
</head>
<body>

<h1>ğŸ“ˆ í˜„ì‹¤ ì‚¬ê±´ ê¸°ë°˜ íˆ¬ì ì‹œë®¬ë ˆì´ì…˜</h1>
<div class="container">

<div class="summary" id="playerInfo"></div>
<div id="eventBox" class="card"></div>
<div id="companies"></div>

<button class="next" onclick="nextPhase()">ë‹¤ìŒ ë‹¨ê³„</button>

</div>

<script>

let phase = 0;

let player = {
  cash: 1000000,
  holdings: {}
};

// ===== ê¸°ì¤€ ë°ì´í„° =====
const companies = [
{ label:"Aì‚¬ (ë°˜ë„ì²´)", eps:12000, per:10, roe:16, debt:38 },
{ label:"Bì‚¬ (ì „ê¸°ì°¨)", eps:5000, per:50, roe:20, debt:25 },
{ label:"Cì‚¬ (í”Œë«í¼)", eps:3000, per:30, roe:14, debt:45 }
];

companies.forEach(c => c.price = Math.round(c.eps * c.per));

// ===== í˜„ì‹¤ ê¸°ë°˜ ì´ë²¤íŠ¸ 4ë‹¨ê³„ =====
const events = [

{
  title:"ì´ë²¤íŠ¸1 ì‹œì‘: ê¸€ë¡œë²Œ ê¸ˆë¦¬ ê¸‰ë“±",
  description:"ê¸´ì¶• ê°•í™”ë¡œ ì„±ì¥ì£¼ ë°¸ë¥˜ì—ì´ì…˜ ê¸‰ë½",
  effects:[
    { eps:-0.10, per:-2 },   // ë°˜ë„ì²´ í•˜ë½
    { eps:-0.10, per:-20 },  // ì „ê¸°ì°¨ ëŒ€í­ë½
    { eps:-0.05, per:-10 }   // í”Œë«í¼ í•˜ë½
  ]
},

{
  title:"ì´ë²¤íŠ¸2 ì‹œì‘: ë°˜ë„ì²´ ì—…í™© ì¹¨ì²´ + í”Œë«í¼ ê·œì œ ì´ìŠˆ",
  description:"ë©”ëª¨ë¦¬ ê°€ê²© ê¸‰ë½ê³¼ ê·œì œ ë¦¬ìŠ¤í¬ í™•ëŒ€",
  effects:[
    { eps:-0.40, per:-2 },   // ë°˜ë„ì²´ í­ë½
    { eps:-0.05, per:-3 },   // ì „ê¸°ì°¨ ì†Œí­ í•˜ë½
    { eps:-0.15, per:-5 }    // í”Œë«í¼ í•˜ë½
  ]
},

{
  title:"ì´ë²¤íŠ¸3 ì‹œì‘: ì „ê¸°ì°¨ ê°€ê²© ì¸í•˜ ì „ìŸ",
  description:"ë§ˆì§„ ì••ë°• ì‹¬í™”, ì¼ë¶€ ê¸°ìˆ ì£¼ ë°˜ë“±",
  effects:[
    { eps:+0.05, per:+2 },   // ë°˜ë„ì²´ ì†Œí­ ë°˜ë“±
    { eps:-0.25, per:-10 },  // ì „ê¸°ì°¨ ê¸‰ë½
    { eps:+0.10, per:+3 }    // í”Œë«í¼ ìƒìŠ¹
  ]
},

{
  title:"ì´ë²¤íŠ¸4 ì‹œì‘: AI ì—´í’ í™•ì‚°",
  description:"AI ìˆ˜ìš” ì¦ê°€ë¡œ ê¸°ìˆ ì£¼ ì¬í‰ê°€",
  effects:[
    { eps:+0.35, per:+6 },   // ë°˜ë„ì²´ ëŒ€í­ ìƒìŠ¹
    { eps:+0.20, per:+10 },  // ì „ê¸°ì°¨ ìƒìŠ¹
    { eps:+0.08, per:+4 }    // í”Œë«í¼ ìƒìŠ¹
  ]
}

];

// ===== ë Œë” =====
function render(){

  document.getElementById("playerInfo").innerHTML =
    `ğŸ’° ë³´ìœ  í˜„ê¸ˆ: ${player.cash.toLocaleString()}ì›`;

  let html = "";

  companies.forEach((c,i)=>{

    if(!player.holdings[i]) player.holdings[i]=0;

    html += `
    <div class="card">
      <h3>${c.label}</h3>
      ì£¼ê°€: ${c.price.toLocaleString()}ì›<br>
      EPS: ${c.eps.toLocaleString()}<br>
      PER: ${c.per}<br>
      ROE: ${c.roe}%<br>
      ë¶€ì±„ë¹„ìœ¨: ${c.debt}%<br>
      ë³´ìœ ìˆ˜ëŸ‰: ${player.holdings[i]}ì£¼<br><br>

      ìˆ˜ëŸ‰: <input type="number" id="qty${i}" value="1" min="1"
      oninput="preview(${i})">

      <div id="preview${i}"></div>

      <button class="buy" onclick="buy(${i})">ë§¤ìˆ˜</button>
      <button class="sell" onclick="sell(${i})">ë§¤ë„</button>
    </div>
    `;
  });

  document.getElementById("companies").innerHTML = html;
}

function preview(i){
  const qty = parseInt(document.getElementById("qty"+i).value)||0;
  const cost = qty * companies[i].price;
  document.getElementById("preview"+i).innerHTML =
    `ì˜ˆìƒ ë§¤ìˆ˜ í›„ ì”ì•¡: ${(player.cash - cost).toLocaleString()}ì›<br>
     ì˜ˆìƒ ë§¤ë„ í›„ ì”ì•¡: ${(player.cash + cost).toLocaleString()}ì›`;
}

function buy(i){
  const qty = parseInt(document.getElementById("qty"+i).value);
  const cost = qty * companies[i].price;
  if(cost > player.cash){ alert("í˜„ê¸ˆ ë¶€ì¡±"); return; }
  player.cash -= cost;
  player.holdings[i] += qty;
  render();
}

function sell(i){
  const qty = parseInt(document.getElementById("qty"+i).value);
  if(qty > player.holdings[i]){ alert("ë³´ìœ  ìˆ˜ëŸ‰ ë¶€ì¡±"); return; }
  player.cash += qty * companies[i].price;
  player.holdings[i] -= qty;
  render();
}

function applyEvent(ev){

  let summary = `<h3>${ev.title}</h3>${ev.description}<br><br>`;

  companies.forEach((c,i)=>{

    const beforePrice = c.price;

    c.eps = Math.round(c.eps * (1 + ev.effects[i].eps));
    c.per += ev.effects[i].per;
    if(c.per < 1) c.per = 1;

    c.price = Math.round(c.eps * c.per);

    summary += `
    <b>${c.label}</b><br>
    ì£¼ê°€: ${beforePrice.toLocaleString()} â†’ ${c.price.toLocaleString()}<br><br>
    `;
  });

  document.getElementById("eventBox").innerHTML = summary;
}

function nextPhase(){

  if(phase < events.length){
    applyEvent(events[phase]);
    phase++;
    render();
  }
  else{
    finalResult();
  }
}

function finalResult(){
  let total = player.cash;
  companies.forEach((c,i)=>{
    total += player.holdings[i]*c.price;
  });

  const rate = ((total-1000000)/1000000*100).toFixed(2);

  document.getElementById("eventBox").innerHTML =
    `<h2>ğŸ ìµœì¢… ê²°ê³¼</h2>
     ì´ ìì‚°: ${total.toLocaleString()}ì›<br>
     ìˆ˜ìµë¥ : ${rate}%`;

  document.querySelector(".next").style.display="none";
}

// ì‹œì‘ ì‹œ ì´ë²¤íŠ¸1 ë°”ë¡œ í‘œì‹œ
applyEvent(events[0]);
phase = 1;
render();

</script>
</body>
</html>